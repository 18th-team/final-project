<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main-layout}">
<head>
    <title>Club Update</title>
    <link th:href="@{/css/update.css}" rel="stylesheet"/>
</head>
<body>
<div layout:fragment="content">
    <div class="container my-5 shadow-lg p-4 rounded-3 w-80">
        <h1 class="mb-5 text-center fw-bold">ν¬λ£¨ μμ •ν•κΈ° π³</h1>
        <form th:action="@{/clubs/update}" method="post" id="clubForm" class="needs-validation" novalidate
              enctype="multipart/form-data">
            <!-- Hidden ID -->
            <input type="hidden" name="id" th:value="${clubUpdate.id}">

            <!-- Title -->
            <div class="mb-3">
                <label for="title" class="form-label create-name text-dark">ν¬λ£¨λ… π³</label>
                <input type="text" name="title" id="title" class="form-control" th:value="${clubUpdate.title}" required>
                <div class="invalid-feedback">μ λ©μ„ μ…λ ¥ν•΄μ£Όμ„Έμ”.</div>
            </div>

            <!-- Content -->
            <div class="mb-3">
                <label for="content" class="form-label create-name text-dark">ν¬λ£¨ μ„¤λ… βοΈ</label>
                <textarea name="content" id="content" class="form-control" rows="4" th:text="${clubUpdate.content}"
                          required></textarea>
                <div class="invalid-feedback">λ‚΄μ©μ„ μ…λ ¥ν•΄μ£Όμ„Έμ”.</div>
            </div>

            <!-- μ£Όμ† -->
            <div class="row">
                <div class="col-10">
                    <label for="search-query" class="form-label create-name text-dark">λ¨μ„ μ¥μ† π©</label>
                    <input type="text" id="search-query" placeholder="μ£Όμ† κ²€μƒ‰" name="address"
                           class="form-control border-primary" required th:value="${clubUpdate.locationTitle}">
                    <div class="invalid-feedback" id="fields-feedback">μ£Όμ†λ¥Ό λ‹¤μ‹ ν™•μΈν•΄μ£Όμ„Έμ”π…</div>

                </div>
                <div class="col-2 d-flex align-items-center">
                    <button type="button" class="btn btn-primary w-100" onclick="searchAddress()">κ²€μƒ‰</button>
                </div>
            </div>
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <div id="search-results"></div>
                </div>
                <div id="map" class="col-md-6"></div>

                <input type="hidden" name="location" id="location" required th:value="${clubUpdate.location}">
                <input type="hidden" name="locationTitle" id="locationTitle" required
                       th:value="${clubUpdate.locationTitle}">
                <input type="hidden" name="latitude" id="latitude" required th:value="${clubUpdate.latitude}">
                <input type="hidden" name="longitude" id="longitude" required th:value="${clubUpdate.longitude}">
                <div class="invalid-feedback" id="hidden-fields-feedback">μμ„Έν• μ¥μ†λ¥Ό μ„ νƒν•΄μ£Όμ„Έμ”π…</div>
            </div>


            <!-- Age Restriction -->
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <label for="ageRestriction" class="form-label create-name text-dark">κ°€μ… μ΅°κ±΄ λ‚μ΄ π‚</label>
                    <input type="number" name="ageRestriction" id="ageRestriction" class="form-control border-primary"
                           placeholder="20μ„Έ μ΄μƒ μ…λ ¥" step="1" th:value="${clubUpdate.ageRestriction}" required>
                    <div class="invalid-feedback">20μ„Έ μ΄μƒ λ‚μ΄λ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ”! π‘¶</div>
                </div>
                <div class="col-md-6">
                    <label for="selectedTheme" class="form-label create-name text-dark">ν‚¤μ›λ“ μμ •π¨</label>
                    <select name="selectedTheme" id="selectedTheme" class="form-select border-primary" required>
                        <option value="">μ„ νƒν•μ„Έμ”</option>
                        <option value="μ•΅ν‹°λΉ„ν‹°" th:selected="${clubUpdate.selectedTheme == 'μ•΅ν‹°λΉ„ν‹°'}">μ•΅ν‹°λΉ„ν‹° πƒ</option>
                        <option value="μκΈ°κ³„λ°" th:selected="${clubUpdate.selectedTheme == 'μκΈ°κ³„λ°'}">μκΈ°κ³„λ° π“</option>
                        <option value="μ·¨λ―Έ" th:selected="${clubUpdate.selectedTheme == 'μ·¨λ―Έ'}">μ·¨λ―Έ π®</option>
                        <option value="μ—¬ν–‰" th:selected="${clubUpdate.selectedTheme == 'μ—¬ν–‰'}">μ—¬ν–‰ βοΈ</option>
                        <option value="λ¬Έν™”/μμ " th:selected="${clubUpdate.selectedTheme == 'λ¬Έν™”/μμ '}">λ¬Έν™”/μμ  π­</option>
                        <option value="ν‘Έλ“/λ“λ§ν¬" th:selected="${clubUpdate.selectedTheme == 'ν‘Έλ“/λ“λ§ν¬'}">ν‘Έλ“/λ“λ§ν¬ π”</option>
                    </select>
                    <div class="invalid-feedback">ν…λ§λ¥Ό κ³¨λΌμ£Όμ„Έμ”! π¤”</div>
                </div>
            </div>

            <!-- μ΄λ―Έμ§€ μμ • -->
            <div class="mb-4">
                <label for="clubFile" class="form-label create-name text-dark">μ‚¬μ§„ μ—…λ΅λ“ π“Έ</label>
                <input type="file" name="clubFile" id="clubFile" class="form-control" multiple accept="image/*">
                <small class="form-text text-muted">μƒλ΅μ΄ νμΌμ„ μ„ νƒν•λ©΄ κΈ°μ΅΄ μ‚¬μ§„μ΄ κµμ²΄λ©λ‹λ‹¤.</small>
                <div th:if="${clubUpdate.fileAttached == 1}" class="mt-3">
                    <h6>ν„μ¬ λ“±λ΅λ μ‚¬μ§„</h6>
                    <div class="d-flex flex-wrap gap-3">
                        <img th:each="fileName : ${clubUpdate.storedFileName}" th:src="@{|/upload/${fileName}|}"
                             class="img-thumbnail" style="max-width: 150px; max-height: 150px;" alt="ν„μ¬ μ‚¬μ§„">
                    </div>
                </div>
                <div id="preview" class="mt-3 d-flex flex-wrap gap-3"></div>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn btn-primary">μμ •ν•κΈ°</button>
            <a th:href="@{/clubs}" class="btn btn-secondary">Back to List</a>
        </form>
    </div>
</div>
</body>
</html>